{"version":3,"file":"src_app_paymentpage_paymentpage_module_ts.js","mappings":"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","sources":["./src/app/paymentpage/paymentpage-routing.module.ts","./src/app/paymentpage/paymentpage.module.ts","./src/app/paymentpage/paymentpage.page.ts","./src/app/paymentpage/paymentpage.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { PaymentpagePage } from './paymentpage.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PaymentpagePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class PaymentpagePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n\nimport { ReactiveFormsModule,FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { PaymentpagePageRoutingModule } from './paymentpage-routing.module';\n\nimport { PaymentpagePage } from './paymentpage.page';\nimport {TranslateModule} from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    ReactiveFormsModule,\n    CommonModule,TranslateModule,\n    FormsModule,\n    IonicModule,\n    PaymentpagePageRoutingModule\n  ],\n  declarations: [PaymentpagePage]\n})\nexport class PaymentpagePageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Storage } from '@ionic/storage';\nimport { Http, Headers, RequestOptions } from '@angular/http';\nimport { HttpClient } from '@angular/common/http';\nimport { ApiService } from '../api.service';\n// import { Stripe } from '@awesome-cordova-plugins/stripe/ngx';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport * as moment from 'moment';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport {\n  DocumentViewer,\n  DocumentViewerOptions,\n} from '@awesome-cordova-plugins/document-viewer/ngx';\nimport { FilePath } from '@ionic-native/file-path/ngx';\nimport { File, FileEntry } from '@ionic-native/file/ngx';\nimport { FileOpener } from '@awesome-cordova-plugins/file-opener/ngx';\n\nimport { Platform } from '@ionic/angular';\n\n@Component({\n  selector: 'app-paymentpage',\n  templateUrl: './paymentpage.page.html',\n  styleUrls: ['./paymentpage.page.scss'],\n})\nexport class PaymentpagePage implements OnInit {\n  bookingDetail: any = {};\n  cardDetails: any = {};\n  stripe_key = 'pk_test_8iBMx9Sz5C5oYRZpccfvTNdF00LMtI9Tbq';\n  cvc;\n  cardNumber;\n  expMonth;\n  expYear;\n  submitted;\n  pageRoute;\n\n  paymentForm: FormGroup;\n  constructor(\n    public storage: Storage,\n    public http: Http,\n    public httpClient: HttpClient,\n    private fileOpener: FileOpener,\n    public api: ApiService,\n    // public stripe: Stripe,\n    private formBuilder: FormBuilder,\n    private document: DocumentViewer,\n    public router: Router,\n    public route: ActivatedRoute,\n    public file: File,\n    // public fileTransfer: FileTransfer,\n    public platform: Platform\n  ) {\n    this.submitted = false;\n    this.creatform();\n    this.route.queryParams.subscribe((params) => {\n      if (params && params.special) {\n        var details = JSON.parse(params.special);\n        this.pageRoute = details.pageRoute;\n      }\n    });\n  }\n\n  ngOnInit() {\n    this.storage.get('bookingrequest').then((bookingDetail) => {\n      this.bookingDetail = bookingDetail;\n      console.log(this.bookingDetail);\n    });\n  }\n\n  creatform() {\n    this.paymentForm = this.formBuilder.group({\n      cardnumber: ['', Validators.required],\n      expiration: ['', Validators.required],\n      cvc: ['', Validators.required],\n\n      conditions: ['false', Validators.requiredTrue],\n    });\n  }\n\n  get f() {\n    return this.paymentForm.controls;\n  }\n  onSubmit() {\n    console.log('working');\n    this.submitted = true;\n\n    // stop here if form is invalid\n    if (this.paymentForm.invalid) {\n      return;\n    } else {\n      // this.payWithStripe();\n    }\n  }\n\n  setconditions(x) {\n    this.paymentForm.patchValue({ conditions: x });\n  }\n\n  conditionsPage() {\n    let filePath = this.file.applicationDirectory + 'www/assets';\n    if (this.platform.is('android')) {\n      let fakeName = Date.now();\n      this.file\n        .copyFile(\n          filePath,\n          'payment.pdf',\n          this.file.dataDirectory,\n          `${fakeName}.pdf`\n        )\n        .then((results) => {\n          this.fileOpener.open(results.nativeURL, 'application/pdf');\n        });\n    } else {\n      const options: DocumentViewerOptions = {\n        title: 'CGV',\n      };\n\n      this.document.viewDocument(\n        `${filePath}/payment.pdf`,\n        'application/pdf',\n        options\n      );\n    }\n  }\n\n  // payWithStripe() {\n  //   this.stripe.setPublishableKey(this.stripe_key);\n  //   var expMonth = moment(this.paymentForm.value.expiration).format('MM');\n  //   var expYear = moment(this.paymentForm.value.expiration).format('YYYY');\n  //   this.cardDetails = {\n  //     number: this.paymentForm.value.cardnumber,\n  //     expMonth: expMonth,\n  //     expYear: expYear,\n  //     cvc: this.paymentForm.value.cvc,\n  //   };\n\n  //   console.log(this.cardDetails);\n  //   console.log(this.stripe_key);\n\n  //   this.stripe\n  //     .createCardToken(this.cardDetails)\n  //     .then((token) => {\n  //       console.log(token);\n  //       this.makePayment(token.id);\n  //     })\n  //     .catch((error) => console.error(error));\n  // }\n\n  makePayment(stripeToken?) {\n    this.api.loading();\n    const formData = new FormData();\n    formData.append('book_user_id', this.bookingDetail.book_user_id);\n    formData.append('book_host_id', this.bookingDetail.book_host_id);\n    formData.append('book_user_f_name', this.bookingDetail.book_user_f_name);\n    formData.append('book_user_l_name', this.bookingDetail.book_user_l_name);\n    formData.append('book_event_id', this.bookingDetail.book_event_id);\n    formData.append('book_event_date', this.bookingDetail.book_event_date);\n    formData.append(\n      'book_event_address',\n      this.bookingDetail.book_event_address\n    );\n    formData.append('stripeToken', stripeToken);\n    this.http\n      .post(\n        'http://fitconnected.prometteur.in/index.php/Api/madd/book',\n        formData\n      )\n      .subscribe((res) => {\n        if (res.json().status == 1) {\n          if (res.json().msg === 'Event is already booked') {\n            this.api.toast('Votre demande a bien été envoyée');\n            this.api.dismissLoading();\n            this.back();\n          } else {\n            console.log(res.json());\n            this.api.dismissLoading();\n            var msg = \"L'événement est déjà réservé\";\n            this.api.toast(msg);\n            this.back();\n          }\n        } else {\n          console.log(res.json());\n        }\n      });\n  }\n\n  back() {\n    this.api.Navigate(this.pageRoute);\n  }\n}\n","export default \"<ion-header no-border class=\\\"header-fixed-top\\\">\\n  <ion-toolbar class=\\\"top-global-toolbar\\\">\\n      <ion-buttons slot=\\\"start\\\">\\n          <ion-back-button text=\\\"\\\" defaultHref=\\\"response3\\\"></ion-back-button>\\n      </ion-buttons>\\n      <ion-title style=\\\"font-family:montserrat-medium;\\\" class=\\\"top-fixed-heading uppercaes\\\" [translate]=\\\"'PAYMENT.Text1'\\\"></ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n\\n\\n<ion-content>\\n  <form [formGroup]=\\\"paymentForm\\\" (ngSubmit)=\\\"onSubmit()\\\">\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label position=\\\"floating\\\" [translate]=\\\"'PAYMENT.Text2'\\\">\\n       </ion-label>\\n      <ion-input type=\\\"tel\\\" formControlName=\\\"cardnumber\\\" name=\\\"cardnumber\\\"></ion-input>\\n      \\n      <div *ngIf=\\\"submitted && f.cardnumber.errors\\\" class=\\\"invalid-feedback left\\\">\\n        <div *ngIf=\\\"f.cardnumber.errors.required\\\" [translate]=\\\"'PAYMENT.Text3'\\\"></div>\\n    </div>\\n    </ion-item>\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label position=\\\"floating\\\" [translate]=\\\"'PAYMENT.Text4'\\\">\\n        </ion-label>\\n        <ion-datetime pickerFormat=\\\"MM/YYYY\\\" displayFormat=\\\"MM/YYYY\\\"\\n        monthShortNames=\\\"jan,fév,mar,avr,mai,juin,juillet,août,sept,oct,nov,déc\\\" cancelText=\\\"annuler\\\" doneText=\\\"Valider\\\" min=\\\"2020\\\" max=\\\"2050\\\" formControlName=\\\"expiration\\\" name=\\\"expiration\\\"></ion-datetime>\\n     \\n      <div *ngIf=\\\"submitted && f.expiration.errors\\\" class=\\\"invalid-feedback left\\\">\\n        <div *ngIf=\\\"f.expiration.errors.required\\\" [translate]=\\\"'PAYMENT.Text5'\\\"></div>\\n    </div>\\n    </ion-item>\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label position=\\\"floating\\\">CVC*</ion-label>\\n      <ion-input type=\\\"tel\\\" formControlName=\\\"cvc\\\" name=\\\"cvc\\\"></ion-input>\\n      <div *ngIf=\\\"submitted && f.cvc.errors\\\" class=\\\"invalid-feedback left\\\">\\n        <div *ngIf=\\\"f.cvc.errors.required\\\" [translate]=\\\"'PAYMENT.Text6'\\\"></div>\\n        \\n    </div>\\n    </ion-item>\\n\\n    <ion-row style=\\\"margin-top: 5%;\\\">\\n      <ion-col size=\\\"2\\\" style=\\\"display: flex;\\n      justify-content: flex-end;\\\">\\n        \\n          <ion-checkbox mode=\\\"ios\\\" formControlName=\\\"conditions\\\" name=\\\"conditions\\\" (ngModelChange)=\\\"setconditions($event)\\\"></ion-checkbox>\\n        \\n        \\n      </ion-col>\\n      \\n      <ion-col size=\\\"10\\\">\\n        \\n          <ion-label style=\\\"font-size: 14px;margin-top: 19px;\\\" [translate]=\\\"'PAYMENT.Text7'\\\">\\n            <b (click)=\\\"conditionsPage()\\\" class=\\\"ion-no-padding\\\"\\n              style=\\\"text-decoration: underline;font-family: montserrat-medium;font-weight: bold;\\\" [translate]=\\\"'PAYMENT.Text8'\\\">\\n              CONDITIONS GENERALES D’UTILISATION\\n            </b>\\n          </ion-label>\\n        \\n      </ion-col>\\n      <div *ngIf=\\\"submitted && f.conditions.errors\\\" class=\\\"invalid-feedback left\\\" style=\\\"width: 100%;text-align: center;\\\">\\n        <div *ngIf=\\\"f.conditions.errors.required\\\" [translate]=\\\"'PAYMENT.Text9'\\\">Veuillez accepter les termes et conditions</div>\\n    </div>\\n    </ion-row>\\n\\n    <ion-item lines=\\\"none\\\">\\n      <button style=\\\"font-size: 12px; \\\" type=\\\"submit\\\" ion-button class=\\\"global-submit-button global-btn themecolor\\\" [translate]=\\\"'PAYMENT.Text10'\\\">\\n        effectuer le paiement\\n      </button>\\n    </ion-item>\\n    </form>\\n\\n</ion-content>\\n\";"],"names":[],"sourceRoot":"webpack:///"}